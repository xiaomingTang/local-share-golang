# LocalShare（local-share-golang）

一个基于 Go + Wails 的局域网文件夹共享工具：选择一个本地文件夹后，会在本机启动一个 HTTP 服务，并提供可在手机/电脑浏览器打开的网页界面用于浏览、下载、预览与上传。

本项目为**纯绿色应用（免安装/便携版）**：下载/解压后即可运行，不依赖系统服务。可选功能（Windows 资源管理器右键菜单）会写入当前用户注册表（HKCU），无需管理员权限，可随时在应用内关闭。

## 预览

- 客户端
  ![客户端预览](./docs/assets/preview.png)
- 网页文件管理页面
  ![网页文件管理页面预览](./docs/assets/preview-web.png)
  ![网页文件管理页面预览](./docs/assets/preview-web-2.png)

## 主要功能

- 共享本机任意文件夹到局域网：生成访问地址（形如 `http://<本机IP>:<端口>`）
- 生成二维码：手机扫码即可打开共享页面
- 访问口令（可选）：为共享网页设置访问口令，避免同一 Wi‑Fi 下被随意访问
- 网页端文件管理：目录浏览、文件下载、文件预览（按浏览器支持的类型）、文件上传
- Windows 集成：可选启用“右键共享此文件夹”（对文件夹与文件夹空白处生效）

## 使用方法（普通用户）

1. 运行程序（Windows 下为 `local-share-golang.exe`）。
2. 在界面中选择要共享的文件夹并启动共享。
3. 使用同一局域网内的设备访问：
   - 直接在浏览器打开界面显示的 URL；或
   - 用手机扫描界面显示的二维码。
4. 在网页中浏览文件并进行下载/预览/上传。
5. 不需要共享时，点击停止共享。

提示：访问设备必须与电脑在同一局域网（同一 Wi-Fi/同网段）。如打不开，优先检查防火墙是否拦截。

## Windows 右键菜单（可选）

启用后，你可以在资源管理器中对文件夹使用右键菜单：

- 在文件夹上右键：选择“共享此文件夹”
- 在文件夹空白处右键：选择“共享此文件夹”（共享当前目录）

应用会以参数方式启动：`--share="<路径>"`。

说明：该功能写入当前用户注册表（HKCU\Software\Classes\...），无需管理员权限；禁用后会清理对应键值。

## 纯绿色应用说明

本项目定位为**纯绿色/免安装**：

- 不需要安装器，不需要写入系统服务
- 程序文件放哪都能运行，删除程序文件夹即可“卸载”
- 唯一可能的系统改动来自“Windows 右键菜单”这一可选功能（仅当前用户范围，且可在应用内关闭并清理）

## 常见问题

### 1) 只需要在一台 Windows 电脑下载并运行吗？其他设备要装吗？

LocalShare 在 Windows 上启动共享服务；**其他设备**（手机、Mac 或其他电脑）**无需**安装客户端，只要在同一 Wi‑Fi/同一网络内用浏览器访问地址即可进行文件浏览、上传、下载和预览。

### 2) 它是绿色软件吗？需要安装吗？

是纯绿色免安装：解压即用。删除程序文件夹即可卸载。

提示：唯一可能的系统改动来自“可选的 Windows 右键菜单”。不开启就不会写入注册表。

### 3) 需要管理员权限吗？

不需要。应用本身可直接运行；可选右键菜单写入的是当前用户注册表（HKCU），同样无需管理员权限。

### 4) 支持“访问口令”吗？怎么用？

支持。你可以在客户端里设置“访问口令”，启用后：访问共享网页会先提示输入口令，通过后会获得一个临时 token（会自动续期），后续操作无需重复输入。

口令规则：1–16 位，仅支持字母/数字。

### 5) 其他设备打不开 URL

- 确保两台设备在同一局域网（同一 Wi‑Fi/同网段）
- 检查 Windows 防火墙/安全软件是否拦截该程序的入站访问
- 确认电脑没有同时启用多个网络导致 IP 选择不正确（可尝试切换网络后重新开始共享）

### 6) 端口会变化吗？

首次启动共享会自动选择一个可用端口；在共享服务已运行时，重复“共享”只会切换共享目录，尽量保持端口不变。

### 7) 重复启动程序会怎样？

程序为单实例：如果已有实例在运行，新启动会把 `--share` 指定的目录转发给已运行实例，并唤醒窗口到前台。

### 8) 我启用了右键菜单，后来直接删了应用，右键菜单还残留怎么办？

> 建议：删除应用前先检查一下——如果你曾启用过右键菜单，先在 LocalShare 界面里一键取消右键菜单，再删除应用会更省心。

右键菜单属于注册表项，删除程序文件并不会自动清理。可以按以下方式移除（仅影响当前用户）：

方法 A：PowerShell 一键清理（推荐）

    ```powershell
    reg.exe delete "HKCU\Software\Classes\Directory\shell\ShareFolder\command" /f
    reg.exe delete "HKCU\Software\Classes\Directory\shell\ShareFolder" /f
    reg.exe delete "HKCU\Software\Classes\Directory\Background\shell\ShareFolder\command" /f
    reg.exe delete "HKCU\Software\Classes\Directory\Background\shell\ShareFolder" /f

    # 让资源管理器刷新右键菜单（可选）
    Stop-Process -Name explorer -Force
    Start-Process explorer
    ```

方法 B：重新下载应用并一键移除（最省心）

1. 重新下载/解压 LocalShare，并运行。
2. 在左下角一键移除右键菜单（只会移除 LocalShare 自己添加的“共享此文件夹”，不会移除你正常的右键菜单的）。
3. 搞定收工，如果应用不需要了，就可以放心删除整个程序文件夹了。

方法 C：手动清理（注册表图形界面）

1. 按 Win + R，输入 `regedit` 回车。
2. 依次定位并删除以下键（如存在）：
   - `HKEY_CURRENT_USER\Software\Classes\Directory\shell\ShareFolder`
   - `HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\ShareFolder`
3. 重启资源管理器或注销/重启电脑，使右键菜单刷新。

## 开发与构建（开发者）

### 依赖

- Go（版本以 `go.mod` 为准）
- Node.js / npm（用于构建前端）
- Wails v2

### 开发模式

- `wails dev`

### 构建发布

- `wails build`

项目配置见 `wails.json`。
